<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IAutomatize - Dashboard Administrativo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #5a2ca0;
            --primary-light: #7c4ddb;
            --primary-dark: #3d1a70;
            --secondary: #f45866;
            --secondary-light: #ff7a85;
            --secondary-dark: #d13e4a;
            --tertiary: #2ca58d;
            --silver: #e0e0e0;
            --silver-dark: #b0b0b0;
            --white: #ffffff;
            --dark: #1a1a2e;
            --light-bg: #f8f9fa;
            --card-bg: #ffffff;
            --danger: #dc3545;
            --warning: #ffc107;
            --success: #28a745;
            --info: #17a2b8;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background-color: var(--light-bg);
            color: var(--dark);
            min-height: 100vh;
            display: flex;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: linear-gradient(180deg, var(--primary-dark), var(--primary));
            color: var(--white);
            height: 100vh;
            position: fixed;
            padding: 25px 0;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            z-index: 100;
            transition: all 0.3s ease;
        }

        .logo-container {
            display: flex;
            align-items: center;
            padding: 0 25px;
            margin-bottom: 30px;
        }

        .logo-container img {
            width: 40px;
            height: 40px;
            margin-right: 10px;
        }

        .logo-container h1 {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .menu {
            flex: 1;
            overflow-y: auto;
        }

        .menu-category {
            margin-bottom: 10px;
            padding: 0 25px;
            font-size: 0.8rem;
            text-transform: uppercase;
            color: var(--silver);
            font-weight: 500;
        }

        .menu-items {
            list-style: none;
            margin-bottom: 20px;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 12px 25px;
            color: var(--silver);
            text-decoration: none;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
            font-weight: 500;
        }

        .menu-item:hover, .menu-item.active {
            background: rgba(255, 255, 255, 0.1);
            color: var(--white);
            border-left-color: var(--secondary);
        }

        .menu-item i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        .user-profile {
            padding: 15px 25px;
            display: flex;
            align-items: center;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-right: 10px;
            overflow: hidden;
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .user-info {
            flex: 1;
        }

        .user-name {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .user-role {
            font-size: 0.75rem;
            color: var(--silver);
        }

        .logout-btn {
            background: none;
            border: none;
            color: var(--silver);
            cursor: pointer;
            font-size: 1.2rem;
            transition: color 0.3s ease;
        }

        .logout-btn:hover {
            color: var(--white);
        }

        /* Main Content */
        .main-content {
            margin-left: 280px;
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            transition: all 0.3s ease;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .welcome-message h1 {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .welcome-message p {
            color: var(--silver-dark);
        }

        .actions {
            display: flex;
            gap: 15px;
        }

        .action-btn {
            background: var(--white);
            border: none;
            border-radius: 10px;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            color: var(--primary);
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        .action-btn i {
            margin-right: 8px;
        }

        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }

        .action-btn.primary {
            background: var(--primary);
            color: var(--white);
        }

        /* Dashboard Sections */
        .dashboard-section {
            margin-bottom: 30px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--primary);
        }

        .section-actions {
            display: flex;
            gap: 10px;
        }

        .section-btn {
            background: none;
            border: none;
            color: var(--primary);
            font-size: 0.9rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Stats Cards Section */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .stat-title {
            font-size: 1rem;
            color: var(--silver-dark);
            font-weight: 500;
        }

        .stat-icon {
            width: 45px;
            height: 45px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--white);
        }

        .stat-icon.purple {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
        }

        .stat-icon.red {
            background: linear-gradient(135deg, var(--secondary-dark), var(--secondary));
        }

        .stat-icon.green {
            background: linear-gradient(135deg, var(--tertiary), #4ecdc4);
        }

        .stat-icon.blue {
            background: linear-gradient(135deg, #3a7bd5, #00d2ff);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-change {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }

        .stat-change.positive {
            color: var(--success);
        }

        .stat-change.negative {
            color: var(--danger);
        }

        .stat-change i {
            margin-right: 5px;
        }

        /* Chart Container */
        .chart-container {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary);
        }

        .chart-filters {
            display: flex;
            gap: 10px;
        }

        .chart-filter {
            background: var(--light-bg);
            border: none;
            border-radius: 20px;
            padding: 8px 15px;
            font-size: 0.85rem;
            color: var(--silver-dark);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .chart-filter.active {
            background: var(--primary);
            color: var(--white);
        }

        .chart {
            width: 100%;
            height: 350px;
            overflow: hidden;
        }

        /* Clients Section */
        .clients-table-container {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            overflow: hidden;
        }

        .clients-table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .clients-table-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary);
        }

        .clients-table-search {
            position: relative;
            width: 300px;
        }

        .clients-table-search input {
            width: 100%;
            padding: 10px 15px 10px 40px;
            border: 1px solid var(--silver);
            border-radius: 8px;
            outline: none;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .clients-table-search input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(90, 44, 160, 0.2);
        }

        .clients-table-search i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--silver-dark);
        }

        .clients-table {
            width: 100%;
            border-collapse: collapse;
        }

        .clients-table th {
            text-align: left;
            padding: 15px;
            font-weight: 600;
            color: var(--primary);
            border-bottom: 2px solid var(--silver);
        }

        .clients-table td {
            padding: 15px;
            border-bottom: 1px solid var(--silver);
        }

        .client-status {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .client-status.ativo {
            background: rgba(40, 167, 69, 0.15);
            color: var(--success);
        }

        .client-status.pendente {
            background: rgba(255, 193, 7, 0.15);
            color: var(--warning);
        }

        .client-status.inativo {
            background: rgba(220, 53, 69, 0.15);
            color: var(--danger);
        }

        .client-name {
            display: flex;
            align-items: center;
        }

        .client-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
            overflow: hidden;
            background-color: var(--primary-light);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-weight: 600;
        }

        .client-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .client-info {
            display: flex;
            flex-direction: column;
        }

        .client-company {
            font-weight: 600;
        }

        .client-email {
            font-size: 0.85rem;
            color: var(--silver-dark);
        }

        .client-actions {
            display: flex;
            gap: 10px;
        }

        .client-action {
            background: none;
            border: none;
            color: var(--silver-dark);
            cursor: pointer;
            font-size: 1.1rem;
            transition: color 0.3s ease;
        }

        .client-action:hover {
            color: var(--primary);
        }

        .client-action.view:hover {
            color: var(--info);
        }

        .client-action.edit:hover {
            color: var(--warning);
        }

        .client-action.delete:hover {
            color: var(--danger);
        }

        /* Health score styling */
        .health-score {
            font-weight: 600;
        }

        .health-score.high {
            color: var(--success);
        }

        .health-score.medium {
            color: var(--warning);
        }

        .health-score.low {
            color: var(--danger);
        }

        /* Tickets Section */
        .tickets-container {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }

        .tickets-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .tickets-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary);
        }

        .tickets-tabs {
            display: flex;
            gap: 10px;
        }

        .tickets-tab {
            background: var(--light-bg);
            border: none;
            border-radius: 20px;
            padding: 8px 15px;
            font-size: 0.85rem;
            color: var(--silver-dark);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tickets-tab.active {
            background: var(--primary);
            color: var(--white);
        }

        .tickets-table {
            width: 100%;
            border-collapse: collapse;
        }

        .tickets-table th {
            text-align: left;
            padding: 15px;
            font-weight: 600;
            color: var(--primary);
            border-bottom: 2px solid var(--silver);
        }

        .tickets-table td {
            padding: 15px;
            border-bottom: 1px solid var(--silver);
        }

        .ticket-status {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .ticket-status.aberto {
            background: rgba(23, 162, 184, 0.15);
            color: var(--info);
        }

        .ticket-status.em_andamento {
            background: rgba(255, 193, 7, 0.15);
            color: var(--warning);
        }

        .ticket-status.resolvido {
            background: rgba(40, 167, 69, 0.15);
            color: var(--success);
        }

        .ticket-status.fechado {
            background: rgba(108, 117, 125, 0.15);
            color: #6c757d;
        }

        .ticket-priority {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .ticket-priority.alta {
            background: rgba(220, 53, 69, 0.15);
            color: var(--danger);
        }

        .ticket-priority.media {
            background: rgba(255, 193, 7, 0.15);
            color: var(--warning);
        }

        .ticket-priority.baixa {
            background: rgba(40, 167, 69, 0.15);
            color: var(--success);
        }

        .ticket-actions {
            display: flex;
            gap: 10px;
        }

        .ticket-action {
            background: none;
            border: none;
            color: var(--silver-dark);
            cursor: pointer;
            font-size: 1.1rem;
            transition: color 0.3s ease;
        }

        .ticket-action:hover {
            color: var(--primary);
        }

        .ticket-action.view:hover {
            color: var(--info);
        }

        .ticket-action.edit:hover {
            color: var(--warning);
        }

        .ticket-action.delete:hover {
            color: var(--danger);
        }

        /* Events Timeline */
        .timeline-container {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .timeline-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .timeline-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary);
        }

        .timeline {
            position: relative;
            max-height: 400px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 20px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--silver);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 25px;
            padding-left: 60px;
        }

        .timeline-item:last-child {
            margin-bottom: 0;
        }

        .timeline-dot {
            position: absolute;
            left: 11px;
            top: 0;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary);
            border: 4px solid var(--white);
            z-index: 1;
        }

        .timeline-dot.venda {
            background: var(--success);
        }

        .timeline-dot.mensagem {
            background: var(--info);
        }

        .timeline-dot.automacao {
            background: var(--warning);
        }

        .timeline-dot.alerta {
            background: var(--danger);
        }

        .timeline-content {
            background: var(--light-bg);
            border-radius: 10px;
            padding: 15px;
            position: relative;
        }

        .timeline-content::before {
            content: '';
            position: absolute;
            left: -8px;
            top: 10px;
            width: 16px;
            height: 16px;
            background: var(--light-bg);
            transform: rotate(45deg);
        }

        .timeline-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-size: 0.85rem;
        }

        .timeline-type {
            font-weight: 600;
            color: var(--primary);
        }

        .timeline-time {
            color: var(--silver-dark);
        }

        .timeline-message {
            font-size: 0.95rem;
            line-height: 1.5;
            margin-bottom: 10px;
        }

        .timeline-details {
            font-size: 0.85rem;
            color: var(--primary);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            transition: color 0.3s ease;
        }

        .timeline-details:hover {
            color: var(--primary-light);
        }

        /* Two Column Layout */
        .two-column-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
        }

        /* Loading state */
        .loading-container {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 30px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(90, 44, 160, 0.1);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 15px;
        }

        .loading-text {
            font-size: 1rem;
            color: var(--primary);
            font-weight: 500;
        }

        .section-loading {
            position: relative;
            min-height: 200px;
        }

        .section-loader {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            border-radius: 15px;
        }

        .table-empty-state {
            text-align: center;
            padding: 40px;
            color: var(--silver-dark);
        }

        .table-empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--silver);
        }

        .table-empty-state p {
            font-size: 1.1rem;
            margin-bottom: 20px;
        }

        /* New Client Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: 15px;
            width: 600px;
            max-width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transform: translateY(30px);
            transition: all 0.3s ease;
        }

        .modal.active .modal-content {
            transform: translateY(0);
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--silver);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.2rem;
            color: var(--silver-dark);
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .modal-close:hover {
            color: var(--primary);
        }

        .modal-body {
            padding: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--silver);
            border-radius: 8px;
            font-size: 0.95rem;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(90, 44, 160, 0.2);
            outline: none;
        }

        .form-select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--silver);
            border-radius: 8px;
            font-size: 0.95rem;
            background-color: var(--white);
            transition: all 0.3s ease;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%235a2ca0'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 20px;
        }

        .form-select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(90, 44, 160, 0.2);
            outline: none;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid var(--silver);
            display: flex;
            justify-content: flex-end;
            gap: 15px;
        }

        .modal-btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-btn.cancel {
            background: var(--light-bg);
            border: 1px solid var(--silver);
            color: var(--silver-dark);
        }

        .modal-btn.cancel:hover {
            background: var(--silver);
            color: var(--dark);
        }

        .modal-btn.submit {
            background: var(--primary);
            border: 1px solid var(--primary);
            color: var(--white);
            position: relative;
        }

        .modal-btn.submit:hover {
            background: var(--primary-dark);
        }

        .modal-btn.submit.loading {
            opacity: 0.7;
            pointer-events: none;
        }

        .modal-btn.submit.loading .btn-text {
            visibility: hidden;
        }

        .modal-btn.submit.loading::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top: 2px solid var(--white);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            left: calc(50% - 10px);
            top: calc(50% - 10px);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        /* Checkbox Group */
        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
            cursor: pointer;
        }

        .checkbox-item label {
            cursor: pointer;
            font-size: 0.95rem;
        }

        /* New Automation Modal */
        .automation-type-option {
            border: 1px solid var(--silver);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .automation-type-option:hover {
            border-color: var(--primary-light);
            background: rgba(90, 44, 160, 0.02);
        }

        .automation-type-option.active {
            border-color: var(--primary);
            background: rgba(90, 44, 160, 0.05);
        }

        .automation-type-header {
            display: flex;
            gap: 15px;
            margin-bottom: 10px;
        }

        .automation-type-icon {
            width: 40px;
            height: 40px;
            background: var(--primary);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 1.2rem;
        }

        .automation-type-title {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .automation-type-desc {
            font-size: 0.9rem;
            color: var(--silver-dark);
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 9999;
        }

        .toast {
            background: var(--white);
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            padding: 15px 20px;
            margin-top: 10px;
            display: flex;
            align-items: center;
            transform: translateX(120%);
            animation: slideIn 0.3s forwards, slideOut 0.3s forwards 4s;
            min-width: 250px;
            max-width: 320px;
        }

        @keyframes slideIn {
            to {
                transform: translateX(0);
            }
        }

        @keyframes slideOut {
            to {
                transform: translateX(120%);
            }
        }

        .toast-icon {
            margin-right: 15px;
            font-size: 1.2rem;
        }

        .toast-icon.success {
            color: var(--success);
        }

        .toast-icon.error {
            color: var(--danger);
        }

        .toast-icon.warning {
            color: var(--warning);
        }

        .toast-icon.info {
            color: var(--info);
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 600;
            margin-bottom: 3px;
        }

        .toast-message {
            font-size: 0.9rem;
            color: var(--silver-dark);
        }

        .toast-close {
            background: none;
            border: none;
            color: var(--silver-dark);
            cursor: pointer;
            font-size: 1rem;
            margin-left: 15px;
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
            gap: 10px;
        }

        .pagination-item {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--white);
            color: var(--dark);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid var(--silver);
        }

        .pagination-item.active {
            background: var(--primary);
            color: var(--white);
            border-color: var(--primary);
        }

        .pagination-item:hover:not(.active) {
            background: var(--light-bg);
        }

        .pagination-item.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Mobile Menu Toggle */
        .mobile-toggle {
            display: none;
            background: none;
            border: none;
            color: var(--primary);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 10px;
            margin-right: 10px;
        }

        /* Media Queries */
        @media (max-width: 1200px) {
            .two-column-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 992px) {
            .sidebar {
                width: 80px;
                padding: 15px 0;
            }
            
            .logo-container {
                justify-content: center;
                padding: 0 15px;
            }
            
            .logo-container img {
                margin-right: 0;
            }
            
            .logo-container h1 {
                display: none;
            }
            
            .menu-category, .menu-item span, .user-info {
                display: none;
            }
            
            .menu-item {
                justify-content: center;
                padding: 15px;
            }
            
            .menu-item i {
                margin-right: 0;
                font-size: 1.2rem;
            }
            
            .user-profile {
                justify-content: center;
                padding: 15px;
            }
            
            .user-avatar {
                margin-right: 0;
            }
            
            .main-content {
                margin-left: 80px;
            }
        }

        @media (max-width: 768px) {
            .mobile-toggle {
                display: block;
            }
            
            .sidebar {
                transform: translateX(-100%);
                width: 250px;
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .logo-container {
                justify-content: flex-start;
                padding: 0 25px;
            }
            
            .logo-container h1 {
                display: block;
            }
            
            .menu-category, .menu-item span, .user-info {
                display: block;
            }
            
            .menu-item {
                justify-content: flex-start;
                padding: 12px 25px;
            }
            
            .menu-item i {
                margin-right: 10px;
            }
            
            .user-profile {
                justify-content: flex-start;
                padding: 15px 25px;
            }
            
            .user-avatar {
                margin-right: 10px;
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .page-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .action-btn span {
                display: none;
            }
            
            .action-btn i {
                margin-right: 0;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .chart-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .clients-table-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .clients-table-search {
                width: 100%;
            }
            
            .tickets-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 576px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .clients-table th:nth-child(3),
            .clients-table td:nth-child(3) {
                display: none;
            }
            
            .tickets-table th:nth-child(3),
            .tickets-table td:nth-child(3) {
                display: none;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--light-bg);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--silver);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--silver-dark);
        }

        /* Canvas for charts */
        canvas {
            width: 100% !important;
            height: 100% !important;
        }

        /* Animations */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="logo-container">
            <img src="https://github.com/user-attachments/assets/8a9ba7b7-5085-42f3-a808-7bef3554fb1d" alt="IAutomatize Logo">
            <h1>IAutomatize</h1>
        </div>

        <div class="menu">
            <div class="menu-category">Navegação Principal</div>
            <ul class="menu-items">
                <a href="#" class="menu-item active">
                    <i class="fas fa-home"></i>
                    <span>Dashboard</span>
                </a>
                <a href="#" class="menu-item">
                    <i class="fas fa-users"></i>
                    <span>Clientes</span>
                </a>
                <a href="#" class="menu-item">
                    <i class="fas fa-ticket-alt"></i>
                    <span>Tickets</span>
                </a>
                <a href="#" class="menu-item">
                    <i class="fas fa-robot"></i>
                    <span>Automações</span>
                </a>
            </ul>

            <div class="menu-category">Inteligência</div>
            <ul class="menu-items">
                <a href="#" class="menu-item">
                    <i class="fas fa-chart-line"></i>
                    <span>Analytics</span>
                </a>
                <a href="#" class="menu-item">
                    <i class="fas fa-brain"></i>
                    <span>Insights IA</span>
                </a>
                <a href="#" class="menu-item">
                    <i class="fas fa-bullseye"></i>
                    <span>Previsões</span>
                </a>
            </ul>

            <div class="menu-category">Configurações</div>
            <ul class="menu-items">
                <a href="#" class="menu-item">
                    <i class="fas fa-cog"></i>
                    <span>Configurações</span>
                </a>
                <a href="#" class="menu-item">
                    <i class="fas fa-user-gear"></i>
                    <span>Perfil</span>
                </a>
                <a href="#" class="menu-item">
                    <i class="fas fa-question-circle"></i>
                    <span>Ajuda</span>
                </a>
            </ul>
        </div>

        <div class="user-profile">
            <div class="user-avatar" id="userAvatarSidebar">
                <img src="" alt="Avatar do usuário" style="display: none;" id="userAvatarImgSidebar">
                <span id="userInitialsSidebar"></span>
            </div>
            <div class="user-info">
                <div class="user-name" id="userNameSidebar">Carregando...</div>
                <div class="user-role">Administrador</div>
            </div>
            <button class="logout-btn" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i>
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Mobile menu toggle -->
        <button class="mobile-toggle" id="mobileToggle">
            <i class="fas fa-bars"></i>
        </button>

        <!-- Header -->
        <div class="page-header">
            <div class="welcome-message">
                <h1 id="welcomeMessage">Bem-vindo!</h1>
                <p id="currentDate"></p>
            </div>
            <div class="actions">
                <button class="action-btn" id="newClientBtn">
                    <i class="fas fa-plus"></i> <span>Novo Cliente</span>
                </button>
                <button class="action-btn primary" id="newAutomationBtn">
                    <i class="fas fa-robot"></i> <span>Nova Automação</span>
                </button>
            </div>
        </div>

        <!-- Stats Section -->
        <div class="dashboard-section">
            <div class="section-header">
                <h2 class="section-title">Visão Geral</h2>
                <div class="section-actions">
                    <button class="section-btn">
                        <i class="fas fa-calendar-alt"></i> Últimos 30 dias
                    </button>
                </div>
            </div>

            <div class="stats-grid" id="statsGrid">
                <div class="loading-container">
                    <div class="loading-spinner"></div>
                    <div class="loading-text">Carregando dados...</div>
                </div>
            </div>
        </div>

        <!-- Performance Chart Section -->
        <div class="dashboard-section">
            <div class="chart-container section-loading" id="performanceChartContainer">
                <div class="section-loader">
                    <div class="loading-spinner"></div>
                </div>
                <div class="chart-header">
                    <h3 class="chart-title">Desempenho de Automações</h3>
                    <div class="chart-filters">
                        <button class="chart-filter" data-period="diario">Diário</button>
                        <button class="chart-filter active" data-period="semanal">Semanal</button>
                        <button class="chart-filter" data-period="mensal">Mensal</button>
                    </div>
                </div>
                <div class="chart">
                    <canvas id="performanceChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Two Column Layout -->
        <div class="two-column-grid">
            <!-- Left Column -->
            <div class="dashboard-section">
                <div class="section-header">
                    <h2 class="section-title">Clientes Recentes</h2>
                    <div class="section-actions">
                        <button class="section-btn" id="filterClientsBtn">
                            <i class="fas fa-filter"></i> Filtrar
                        </button>
                        <button class="section-btn" id="viewAllClientsBtn">
                            <i class="fas fa-eye"></i> Ver todos
                        </button>
                    </div>
                </div>

                <div class="clients-table-container section-loading" id="clientsTableContainer">
                    <div class="section-loader">
                        <div class="loading-spinner"></div>
                    </div>
                    <div class="clients-table-header">
                        <div class="clients-table-title">Top Clientes</div>
                        <div class="clients-table-search">
                            <i class="fas fa-search"></i>
                            <input type="text" placeholder="Pesquisar cliente..." id="clientSearch">
                        </div>
                    </div>

                    <table class="clients-table">
                        <thead>
                            <tr>
                                <th>Cliente</th>
                                <th>Saúde</th>
                                <th>Vendas</th>
                                <th>Status</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="clientsTableBody">
                            <!-- Client rows will be populated dynamically -->
                        </tbody>
                    </table>

                    <div class="pagination" id="clientsPagination">
                        <!-- Pagination will be populated dynamically -->
                    </div>
                </div>
            </div>

            <!-- Right Column -->
            <div class="dashboard-section">
                <div class="section-header">
                    <h2 class="section-title">Atividades Recentes</h2>
                    <div class="section-actions">
                        <button class="section-btn" id="refreshActivitiesBtn">
                            <i class="fas fa-sync-alt"></i> Atualizar
                        </button>
                    </div>
                </div>

                <div class="timeline-container section-loading" id="timelineContainer">
                    <div class="section-loader">
                        <div class="loading-spinner"></div>
                    </div>
                    <div class="timeline" id="activitiesTimeline">
                        <!-- Activities will be populated dynamically -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Tickets Section -->
        <div class="dashboard-section">
            <div class="section-header">
                <h2 class="section-title">Tickets Recentes</h2>
                <div class="section-actions">
                    <button class="section-btn" id="newTicketBtn">
                        <i class="fas fa-plus"></i> Novo Ticket
                    </button>
                    <button class="section-btn" id="viewAllTicketsBtn">
                        <i class="fas fa-eye"></i> Ver todos
                    </button>
                </div>
            </div>

            <div class="tickets-container section-loading" id="ticketsContainer">
                <div class="section-loader">
                    <div class="loading-spinner"></div>
                </div>
                <div class="tickets-header">
                    <div class="tickets-title">Tickets Ativos</div>
                    <div class="tickets-tabs">
                        <button class="tickets-tab active" data-status="todos">Todos</button>
                        <button class="tickets-tab" data-status="aberto">Abertos</button>
                        <button class="tickets-tab" data-status="em_andamento">Em andamento</button>
                        <button class="tickets-tab" data-status="resolvido">Resolvidos</button>
                    </div>
                </div>

                <table class="tickets-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Assunto</th>
                            <th>Cliente</th>
                            <th>Data</th>
                            <th>Status</th>
                            <th>Prioridade</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody id="ticketsTableBody">
                        <!-- Ticket rows will be populated dynamically -->
                    </tbody>
                </table>

                <div class="pagination" id="ticketsPagination">
                    <!-- Pagination will be populated dynamically -->
                </div>
            </div>
        </div>
    </main>

    <!-- New Client Modal -->
    <div class="modal" id="newClientModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Adicionar Novo Cliente</h3>
                <button class="modal-close" id="closeClientModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="newClientForm">
                    <div class="form-group">
                        <label class="form-label">Nome da Empresa</label>
                        <input type="text" class="form-control" id="clientName" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Nome do Contato</label>
                            <input type="text" class="form-control" id="contactName" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-control" id="clientEmail" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Telefone</label>
                            <input type="tel" class="form-control" id="clientPhone" placeholder="(00) 00000-0000">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Status</label>
                            <select class="form-select" id="clientStatus" required>
                                <option value="ativo">Ativo</option>
                                <option value="pendente">Pendente</option>
                                <option value="inativo">Inativo</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Serviços Contratados</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="serviceAssistenteIA">
                                <label for="serviceAssistenteIA">Assistente IA SDR</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="serviceDashboards">
                                <label for="serviceDashboards">Dashboards Personalizados</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="serviceWhatsApp">
                                <label for="serviceWhatsApp">Automação WhatsApp</label>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" id="cancelClientBtn">Cancelar</button>
                <button class="modal-btn submit" id="submitClientBtn">
                    <span class="btn-text">Adicionar Cliente</span>
                </button>
            </div>
        </div>
    </div>

    <!-- New Automation Modal -->
    <div class="modal" id="newAutomationModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Criar Nova Automação</h3>
                <button class="modal-close" id="closeAutomationModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Tipo de Automação</label>
                    <div class="automation-type-options">
                        <div class="automation-type-option active" data-type="sdr">
                            <div class="automation-type-header">
                                <div class="automation-type-icon">
                                    <i class="fas fa-user-plus"></i>
                                </div>
                                <div>
                                    <div class="automation-type-title">Assistente SDR</div>
                                    <div class="automation-type-desc">Automação para prospecção, qualificação e nutrição de leads</div>
                                </div>
                            </div>
                        </div>

                        <div class="automation-type-option" data-type="whatsapp">
                            <div class="automation-type-header">
                                <div class="automation-type-icon">
                                    <i class="fab fa-whatsapp"></i>
                                </div>
                                <div>
                                    <div class="automation-type-title">Automação WhatsApp</div>
                                    <div class="automation-type-desc">Atendimento automático, campanhas e integrações via WhatsApp</div>
                                </div>
                            </div>
                        </div>

                        <div class="automation-type-option" data-type="email">
                            <div class="automation-type-header">
                                <div class="automation-type-icon">
                                    <i class="fas fa-envelope"></i>
                                </div>
                                <div>
                                    <div class="automation-type-title">Campanhas de Email</div>
                                    <div class="automation-type-desc">Sequência de emails automatizados com segmentação</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Cliente</label>
                    <select class="form-select" id="automationClient" required>
                        <option value="">Selecione um cliente</option>
                        <!-- Options will be populated dynamically -->
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Nome da Automação</label>
                    <input type="text" class="form-control" id="automationName" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Descrição</label>
                    <textarea class="form-control" id="automationDescription" rows="3"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" id="cancelAutomationBtn">Cancelar</button>
                <button class="modal-btn submit" id="submitAutomationBtn">
                    <span class="btn-text">Criar Automação</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer">
        <!-- Toast notifications will be added dynamically -->
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Authentication Check
            checkAuthentication();
            
            // DOM elements
            const userNameSidebar = document.getElementById('userNameSidebar');
            const userAvatarSidebar = document.getElementById('userAvatarSidebar');
            const userAvatarImgSidebar = document.getElementById('userAvatarImgSidebar');
            const userInitialsSidebar = document.getElementById('userInitialsSidebar');
            const welcomeMessage = document.getElementById('welcomeMessage');
            const currentDate = document.getElementById('currentDate');
            const logoutBtn = document.getElementById('logoutBtn');
            const mobileToggle = document.getElementById('mobileToggle');
            const sidebar = document.querySelector('.sidebar');
            const statsGrid = document.getElementById('statsGrid');
            const performanceChartContainer = document.getElementById('performanceChartContainer');
            const clientsTableContainer = document.getElementById('clientsTableContainer');
            const timelineContainer = document.getElementById('timelineContainer');
            const ticketsContainer = document.getElementById('ticketsContainer');
            const clientsTableBody = document.getElementById('clientsTableBody');
            const activitiesTimeline = document.getElementById('activitiesTimeline');
            const ticketsTableBody = document.getElementById('ticketsTableBody');
            const clientSearch = document.getElementById('clientSearch');
            const chartFilters = document.querySelectorAll('.chart-filter');
            const ticketsTabs = document.querySelectorAll('.tickets-tab');
            const newClientBtn = document.getElementById('newClientBtn');
            const newAutomationBtn = document.getElementById('newAutomationBtn');
            const newTicketBtn = document.getElementById('newTicketBtn');
            const refreshActivitiesBtn = document.getElementById('refreshActivitiesBtn');
            const viewAllClientsBtn = document.getElementById('viewAllClientsBtn');
            const viewAllTicketsBtn = document.getElementById('viewAllTicketsBtn');
            const newClientModal = document.getElementById('newClientModal');
            const closeClientModal = document.getElementById('closeClientModal');
            const cancelClientBtn = document.getElementById('cancelClientBtn');
            const submitClientBtn = document.getElementById('submitClientBtn');
            const newAutomationModal = document.getElementById('newAutomationModal');
            const closeAutomationModal = document.getElementById('closeAutomationModal');
            const cancelAutomationBtn = document.getElementById('cancelAutomationBtn');
            const submitAutomationBtn = document.getElementById('submitAutomationBtn');
            const automationClient = document.getElementById('automationClient');
            const automationTypeOptions = document.querySelectorAll('.automation-type-option');
            const clientsPagination = document.getElementById('clientsPagination');
            const ticketsPagination = document.getElementById('ticketsPagination');
            
            // Initialize the page
            initializePage();
            
            // =====================
            // Function Definitions
            // =====================
            
            // Authentication Check
            function checkAuthentication() {
                const token = sessionStorage.getItem('authToken');
                const userType = sessionStorage.getItem('userType');
                
                if (!token || userType !== 'admin') {
                    window.location.href = 'login.html';
                }
            }
            
            // Initialize Page
            function initializePage() {
                // Set user data
                setUserData();
                
                // Set current date
                setCurrentDate();
                
                // Add event listeners
                addEventListeners();
                
                // Load data
                loadDashboardData();
            }
            
            // Set User Data
            function setUserData() {
                const userName = sessionStorage.getItem('userName');
                const userAvatar = sessionStorage.getItem('userAvatar');
                
                if (userName) {
                    userNameSidebar.textContent = userName;
                    welcomeMessage.textContent = `Bem-vindo, ${userName.split(' ')[0]}!`;
                }
                
                if (userAvatar) {
                    userAvatarImgSidebar.src = userAvatar;
                    userAvatarImgSidebar.style.display = 'block';
                    userInitialsSidebar.style.display = 'none';
                } else {
                    // Set initials if no avatar
                    if (userName) {
                        const initials = userName.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase();
                        userInitialsSidebar.textContent = initials;
                    }
                }
            }
            
            // Set Current Date
            function setCurrentDate() {
                const now = new Date();
                const options = { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' };
                currentDate.textContent = now.toLocaleDateString('pt-BR', options).replace(/^\w/, c => c.toUpperCase());
            }
            
            // Add Event Listeners
            function addEventListeners() {
                // Mobile menu toggle
                mobileToggle.addEventListener('click', function() {
                    sidebar.classList.toggle('active');
                });
                
                // Logout button
                logoutBtn.addEventListener('click', logout);
                
                // Client search input
                clientSearch.addEventListener('input', debounce(function() {
                    loadClients(1, this.value);
                }, 500));
                
                // Chart filters
                chartFilters.forEach(filter => {
                    filter.addEventListener('click', function() {
                        chartFilters.forEach(f => f.classList.remove('active'));
                        this.classList.add('active');
                        loadPerformanceChart(this.dataset.period);
                    });
                });
                
                // Tickets tabs
                ticketsTabs.forEach(tab => {
                    tab.addEventListener('click', function() {
                        ticketsTabs.forEach(t => t.classList.remove('active'));
                        this.classList.add('active');
                        loadTickets(1, this.dataset.status);
                    });
                });
                
                // New client button
                newClientBtn.addEventListener('click', openClientModal);
                
                // New automation button
                newAutomationBtn.addEventListener('click', openAutomationModal);
                
                // New ticket button
                newTicketBtn.addEventListener('click', openTicketModal);
                
                // Refresh activities button
                refreshActivitiesBtn.addEventListener('click', loadActivities);
                
                // View all clients button
                viewAllClientsBtn.addEventListener('click', viewAllClients);
                
                // View all tickets button
                viewAllTicketsBtn.addEventListener('click', viewAllTickets);
                
                // Client modal
                closeClientModal.addEventListener('click', closeClientModal);
                cancelClientBtn.addEventListener('click', closeClientModal);
                submitClientBtn.addEventListener('click', submitClient);
                
                // Automation modal
                closeAutomationModal.addEventListener('click', closeAutomationModal);
                cancelAutomationBtn.addEventListener('click', closeAutomationModal);
                submitAutomationBtn.addEventListener('click', submitAutomation);
                
                // Automation type options
                automationTypeOptions.forEach(option => {
                    option.addEventListener('click', function() {
                        automationTypeOptions.forEach(o => o.classList.remove('active'));
                        this.classList.add('active');
                    });
                });
            }
            
            // Load Dashboard Data
            function loadDashboardData() {
                loadDashboardStats();
                loadPerformanceChart('semanal');
                loadClients();
                loadActivities();
                loadTickets(1, 'todos');
            }
            
            // Logout Function
            function logout() {
                sessionStorage.removeItem('authToken');
                sessionStorage.removeItem('userType');
                sessionStorage.removeItem('userId');
                sessionStorage.removeItem('userName');
                sessionStorage.removeItem('userEmail');
                sessionStorage.removeItem('userAvatar');
                
                window.location.href = 'login.html';
            }
            
            // =====================
            // Data Loading Functions
            // =====================
            
            // Load Dashboard Stats
            async function loadDashboardStats() {
                try {
                    // Show loading
                    statsGrid.innerHTML = `
                        <div class="loading-container">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">Carregando dados...</div>
                        </div>
                    `;
                    
                    const response = await fetchWithAuth('https://api.iautomatize.com/webhook/admin/estatisticas-gerais');
                    
                    // Check if response is valid
                    if (!response) {
                        throw new Error('Dados inválidos recebidos do servidor');
                    }
                    
                    // Update stats grid
                    statsGrid.innerHTML = `
                        <div class="stat-card">
                            <div class="stat-header">
                                <h3 class="stat-title">Clientes Ativos</h3>
                                <div class="stat-icon purple">
                                    <i class="fas fa-users"></i>
                                </div>
                            </div>
                            <div class="stat-value">${response.clientes_ativos}</div>
                            <div class="stat-change ${response.crescimento_clientes >= 0 ? 'positive' : 'negative'}">
                                <i class="fas fa-arrow-${response.crescimento_clientes >= 0 ? 'up' : 'down'}"></i> 
                                ${Math.abs(response.crescimento_clientes)}% desde o mês passado
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <h3 class="stat-title">Automações Ativas</h3>
                                <div class="stat-icon red">
                                    <i class="fas fa-robot"></i>
                                </div>
                            </div>
                            <div class="stat-value">${response.automacoes_ativas}</div>
                            <div class="stat-change ${response.crescimento_automacoes >= 0 ? 'positive' : 'negative'}">
                                <i class="fas fa-arrow-${response.crescimento_automacoes >= 0 ? 'up' : 'down'}"></i> 
                                ${Math.abs(response.crescimento_automacoes)}% desde o mês passado
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <h3 class="stat-title">Tickets Abertos</h3>
                                <div class="stat-icon green">
                                    <i class="fas fa-ticket-alt"></i>
                                </div>
                            </div>
                            <div class="stat-value">${response.tickets_abertos}</div>
                            <div class="stat-change ${response.crescimento_tickets >= 0 ? 'positive' : 'negative'}">
                                <i class="fas fa-arrow-${response.crescimento_tickets >= 0 ? 'up' : 'down'}"></i> 
                                ${Math.abs(response.crescimento_tickets)}% desde o mês passado
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <h3 class="stat-title">Taxa de Conversão</h3>
                                <div class="stat-icon blue">
                                    <i class="fas fa-chart-pie"></i>
                                </div>
                            </div>
                            <div class="stat-value">${response.taxa_conversao}%</div>
                            <div class="stat-change ${response.crescimento_conversao >= 0 ? 'positive' : 'negative'}">
                                <i class="fas fa-arrow-${response.crescimento_conversao >= 0 ? 'up' : 'down'}"></i> 
                                ${Math.abs(response.crescimento_conversao)}% desde o mês passado
                            </div>
                        </div>
                    `;
                } catch (error) {
                    console.error('Erro ao carregar estatísticas gerais:', error);
                    
                    statsGrid.innerHTML = `
                        <div style="grid-column: 1 / -1; text-align: center; padding: 30px; color: var(--silver-dark);">
                            <i class="fas fa-exclamation-circle" style="font-size: 3rem; margin-bottom: 15px; color: var(--danger);"></i>
                            <p>Não foi possível carregar os dados. Tente novamente mais tarde.</p>
                            <button class="action-btn" onclick="loadDashboardStats()">
                                <i class="fas fa-sync-alt"></i> Tentar novamente
                            </button>
                        </div>
                    `;
                    
                    showToast('Erro', 'Não foi possível carregar as estatísticas gerais', 'error');
                }
            }
            
            // Load Performance Chart
            async function loadPerformanceChart(period = 'semanal') {
                try {
                    // Show loading
                    performanceChartContainer.querySelector('.section-loader').style.display = 'flex';
                    
                    const response = await fetchWithAuth(`https://api.iautomatize.com/webhook/admin/metricas-performance?periodo=${period}`);
                    
                    // Hide loading
                    performanceChartContainer.querySelector('.section-loader').style.display = 'none';
                    
                    // Check if response is valid
                    if (!response || !response.datasets || !response.labels) {
                        throw new Error('Dados inválidos recebidos do servidor');
                    }
                    
                    // Create chart
                    const ctx = document.getElementById('performanceChart').getContext('2d');
                    
                    // Destroy existing chart if exists
                    if (window.performanceChart) {
                        window.performanceChart.destroy();
                    }
                    
                    // Define colors for datasets
                    const colors = [
                        { border: '#5a2ca0', background: 'rgba(90, 44, 160, 0.1)' },
                        { border: '#f45866', background: 'rgba(244, 88, 102, 0.1)' },
                        { border: '#2ca58d', background: 'rgba(44, 165, 141, 0.1)' }
                    ];
                    
                    // Create new chart
                    window.performanceChart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: response.labels,
                            datasets: response.datasets.map((dataset, index) => {
                                return {
                                    label: dataset.label,
                                    data: dataset.data,
                                    borderColor: colors[index % colors.length].border,
                                    backgroundColor: colors[index % colors.length].background,
                                    tension: 0.4,
                                    fill: true
                                };
                            })
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: {
                                    position: 'top',
                                },
                                tooltip: {
                                    mode: 'index',
                                    intersect: false,
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    grid: {
                                        drawBorder: false,
                                    }
                                },
                                x: {
                                    grid: {
                                        display: false,
                                    }
                                }
                            },
                            interaction: {
                                mode: 'nearest',
                                axis: 'x',
                                intersect: false
                            }
                        }
                    });
                } catch (error) {
                    console.error('Erro ao carregar gráfico de desempenho:', error);
                    
                    performanceChartContainer.querySelector('.section-loader').style.display = 'none';
                    
                    document.querySelector('.chart').innerHTML = `
                        <div style="text-align: center; padding: 30px; color: var(--silver-dark);">
                            <i class="fas fa-exclamation-circle" style="font-size: 3rem; margin-bottom: 15px; color: var(--danger);"></i>
                            <p>Não foi possível carregar o gráfico. Tente novamente mais tarde.</p>
                            <button class="action-btn" onclick="loadPerformanceChart('${period}')">
                                <i class="fas fa-sync-alt"></i> Tentar novamente
                            </button>
                        </div>
                    `;
                    
                    showToast('Erro', 'Não foi possível carregar os dados de desempenho', 'error');
                }
            }
            
            // Load Clients
            async function loadClients(page = 1, search = '') {
                try {
                    // Show loading
                    clientsTableContainer.querySelector('.section-loader').style.display = 'flex';
                    
                    // Build URL with parameters
                    let url = `https://api.iautomatize.com/webhook/admin/clientes?page=${page}&per_page=5`;
                    if (search) {
                        url += `&search=${encodeURIComponent(search)}`;
                    }
                    
                    const response = await fetchWithAuth(url);
                    
                    // Hide loading
                    clientsTableContainer.querySelector('.section-loader').style.display = 'none';
                    
                    // Check if response is valid
                    if (!response || !response.clientes) {
                        throw new Error('Dados inválidos recebidos do servidor');
                    }
                    
                    // Clear table
                    clientsTableBody.innerHTML = '';
                    
                    // Check if we have clients
                    if (response.clientes.length > 0) {
                        // Update client dropdown in automation modal
                        updateClientDropdown(response.clientes);
                        
                        // Add clients to table
                        response.clientes.forEach(client => {
                            // Determine health score class
                            let healthClass = 'high';
                            if (client.saude < 70) {
                                healthClass = 'medium';
                            }
                            if (client.saude < 50) {
                                healthClass = 'low';
                            }
                            
                            // Create initials from name if no avatar
                            const initials = client.nome.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase();
                            
                            // Add client row
                            clientsTableBody.innerHTML += `
                                <tr>
                                    <td>
                                        <div class="client-name">
                                            <div class="client-avatar">
                                                ${client.avatar ? 
                                                    `<img src="${client.avatar}" alt="${client.nome}">` : 
                                                    `<span>${initials}</span>`
                                                }
                                            </div>
                                            <div class="client-info">
                                                <div class="client-company">${client.nome}</div>
                                                <div class="client-email">${client.email}</div>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="health-score ${healthClass}">${client.saude}%</div>
                                    </td>
                                    <td>R$ ${client.vendas.toLocaleString('pt-BR')}</td>
                                    <td><span class="client-status ${client.status}">${capitalizeFirstLetter(client.status)}</span></td>
                                    <td>
                                        <div class="client-actions">
                                            <button class="client-action view" data-id="${client.id}" title="Ver detalhes">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                            <button class="client-action edit" data-id="${client.id}" title="Editar cliente">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="client-action delete" data-id="${client.id}" title="Remover cliente">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            `;
                        });
                        
                        // Setup pagination
                        const totalPages = Math.ceil(response.total / 5);
                        setupPagination(clientsPagination, page, totalPages, loadClients, search);
                        
                        // Add event listeners for client actions
                        addClientActionListeners();
                    } else {
                        // No clients found
                        clientsTableBody.innerHTML = `
                            <tr>
                                <td colspan="5" class="table-empty-state">
                                    <i class="fas fa-users-slash"></i>
                                    <p>Nenhum cliente encontrado</p>
                                    <button class="action-btn" id="addFirstClientBtn">
                                        <i class="fas fa-plus"></i> Adicionar Cliente
                                    </button>
                                </td>
                            </tr>
                        `;
                        
                        // Add event listener for add client button
                        document.getElementById('addFirstClientBtn').addEventListener('click', openClientModal);
                        
                        // Clear pagination
                        clientsPagination.innerHTML = '';
                    }
                } catch (error) {
                    console.error('Erro ao carregar clientes:', error);
                    
                    clientsTableContainer.querySelector('.section-loader').style.display = 'none';
                    
                    clientsTableBody.innerHTML = `
                        <tr>
                            <td colspan="5" class="table-empty-state">
                                <i class="fas fa-exclamation-circle" style="font-size: 3rem; margin-bottom: 15px; color: var(--danger);"></i>
                                <p>Não foi possível carregar os clientes. Tente novamente mais tarde.</p>
                                <button class="action-btn" onclick="loadClients()">
                                    <i class="fas fa-sync-alt"></i> Tentar novamente
                                </button>
                            </td>
                        </tr>
                    `;
                    
                    // Clear pagination
                    clientsPagination.innerHTML = '';
                    
                    showToast('Erro', 'Não foi possível carregar os clientes', 'error');
                }
            }
            
            // Load Activities
            async function loadActivities() {
                try {
                    // Show loading
                    timelineContainer.querySelector('.section-loader').style.display = 'flex';
                    
                    const response = await fetchWithAuth('https://api.iautomatize.com/webhook/admin/atividades-recentes');
                    
                    // Hide loading
                    timelineContainer.querySelector('.section-loader').style.display = 'none';
                    
                    // Check if response is valid
                    if (!response || !response.atividades) {
                        throw new Error('Dados inválidos recebidos do servidor');
                    }
                    
                    // Clear timeline
                    activitiesTimeline.innerHTML = '';
                    
                    // Check if we have activities
                    if (response.atividades.length > 0) {
                        // Add activities to timeline
                        response.atividades.forEach(activity => {
                            // Format date
                            const date = new Date(activity.data);
                            const today = new Date();
                            const yesterday = new Date(today);
                            yesterday.setDate(yesterday.getDate() - 1);
                            
                            let formattedDate;
                            if (date.toDateString() === today.toDateString()) {
                                formattedDate = `Hoje, ${date.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}`;
                            } else if (date.toDateString() === yesterday.toDateString()) {
                                formattedDate = `Ontem, ${date.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}`;
                            } else {
                                formattedDate = date.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit', hour: '2-digit', minute: '2-digit' });
                            }
                            
                            // Type display mapping
                            const typeDisplay = {
                                'venda': 'Venda',
                                'mensagem': 'Mensagem',
                                'automacao': 'Automação',
                                'alerta': 'Alerta'
                            };
                            
                            // Add activity to timeline
                            activitiesTimeline.innerHTML += `
                                <div class="timeline-item">
                                    <div class="timeline-dot ${activity.tipo}"></div>
                                    <div class="timeline-content">
                                        <div class="timeline-meta">
                                            <div class="timeline-type">${typeDisplay[activity.tipo] || capitalizeFirstLetter(activity.tipo)}</div>
                                            <div class="timeline-time">${formattedDate}</div>
                                        </div>
                                        <div class="timeline-message">
                                            ${activity.mensagem}
                                        </div>
                                        <a href="${activity.link_detalhes}" class="timeline-details">
                                            Ver detalhes <i class="fas fa-chevron-right"></i>
                                        </a>
                                    </div>
                                </div>
                            `;
                        });
                    } else {
                        // No activities found
                        activitiesTimeline.innerHTML = `
                            <div style="text-align: center; padding: 30px; color: var(--silver-dark);">
                                <i class="fas fa-calendar-times" style="font-size: 3rem; margin-bottom: 15px;"></i>
                                <p>Nenhuma atividade recente encontrada</p>
                            </div>
                        `;
                    }
                } catch (error) {
                    console.error('Erro ao carregar atividades:', error);
                    
                    timelineContainer.querySelector('.section-loader').style.display = 'none';
                    
                    activitiesTimeline.innerHTML = `
                        <div style="text-align: center; padding: 30px; color: var(--silver-dark);">
                            <i class="fas fa-exclamation-circle" style="font-size: 3rem; margin-bottom: 15px; color: var(--danger);"></i>
                            <p>Não foi possível carregar as atividades. Tente novamente mais tarde.</p>
                            <button class="action-btn" onclick="loadActivities()">
                                <i class="fas fa-sync-alt"></i> Tentar novamente
                            </button>
                        </div>
                    `;
                    
                    showToast('Erro', 'Não foi possível carregar as atividades recentes', 'error');
                }
            }
            
            // Load Tickets
            async function loadTickets(page = 1, status = 'todos') {
                try {
                    // Show loading
                    ticketsContainer.querySelector('.section-loader').style.display = 'flex';
                    
                    // Build URL with parameters
                    let url = `https://api.iautomatize.com/webhook/admin/tickets?page=${page}&per_page=5`;
                    if (status !== 'todos') {
                        url += `&status=${status}`;
                    }
                    
                    const response = await fetchWithAuth(url);
                    
                    // Hide loading
                    ticketsContainer.querySelector('.section-loader').style.display = 'none';
                    
                    // Check if response is valid
                    if (!response || !response.tickets) {
                        throw new Error('Dados inválidos recebidos do servidor');
                    }
                    
                    // Clear table
                    ticketsTableBody.innerHTML = '';
                    
                    // Check if we have tickets
                    if (response.tickets.length > 0) {
                        // Status display mapping
                        const statusDisplay = {
                            'aberto': 'Aberto',
                            'em_andamento': 'Em andamento',
                            'resolvido': 'Resolvido',
                            'fechado': 'Fechado'
                        };
                        
                        // Priority display mapping
                        const priorityDisplay = {
                            'alta': 'Alta',
                            'media': 'Média',
                            'baixa': 'Baixa'
                        };
                        
                        // Add tickets to table
                        response.tickets.forEach(ticket => {
                            // Format date
                            const date = new Date(ticket.data_criacao);
                            const formattedDate = date.toLocaleDateString('pt-BR');
                            
                            // Create initials from client name if no avatar
                            const initials = ticket.cliente_nome.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase();
                            
                            // Add ticket row
                            ticketsTableBody.innerHTML += `
                                <tr>
                                    <td>${ticket.id}</td>
                                    <td>${ticket.assunto}</td>
                                    <td>
                                        <div class="client-name">
                                            <div class="client-avatar">
                                                ${ticket.cliente_avatar ? 
                                                    `<img src="${ticket.cliente_avatar}" alt="${ticket.cliente_nome}">` : 
                                                    `<span>${initials}</span>`
                                                }
                                            </div>
                                            <span>${ticket.cliente_nome}</span>
                                        </div>
                                    </td>
                                    <td>${formattedDate}</td>
                                    <td><span class="ticket-status ${ticket.status}">${statusDisplay[ticket.status] || ticket.status}</span></td>
                                    <td><span class="ticket-priority ${ticket.prioridade}">${priorityDisplay[ticket.prioridade] || ticket.prioridade}</span></td>
                                    <td>
                                        <div class="ticket-actions">
                                            <button class="ticket-action view" data-id="${ticket.id}" title="Ver detalhes">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                            <button class="ticket-action edit" data-id="${ticket.id}" title="Editar ticket">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            `;
                        });
                        
                        // Setup pagination
                        const totalPages = Math.ceil(response.total / 5);
                        setupPagination(ticketsPagination, page, totalPages, loadTickets, status);
                        
                        // Add event listeners for ticket actions
                        addTicketActionListeners();
                    } else {
                        // No tickets found
                        ticketsTableBody.innerHTML = `
                            <tr>
                                <td colspan="7" class="table-empty-state">
                                    <i class="fas fa-ticket-alt"></i>
                                    <p>Nenhum ticket encontrado</p>
                                </td>
                            </tr>
                        `;
                        
                        // Clear pagination
                        ticketsPagination.innerHTML = '';
                    }
                } catch (error) {
                    console.error('Erro ao carregar tickets:', error);
                    
                    ticketsContainer.querySelector('.section-loader').style.display = 'none';
                    
                    ticketsTableBody.innerHTML = `
                        <tr>
                            <td colspan="7" class="table-empty-state">
                                <i class="fas fa-exclamation-circle" style="font-size: 3rem; margin-bottom: 15px; color: var(--danger);"></i>
                                <p>Não foi possível carregar os tickets. Tente novamente mais tarde.</p>
                                <button class="action-btn" onclick="loadTickets(1, '${status}')">
                                    <i class="fas fa-sync-alt"></i> Tentar novamente
                                </button>
                            </td>
                        </tr>
                    `;
                    
                    // Clear pagination
                    ticketsPagination.innerHTML = '';
                    
                    showToast('Erro', 'Não foi possível carregar os tickets', 'error');
                }
            }
            
            // =====================
            // Helper Functions
            // =====================
            
            // Capitalize First Letter
            function capitalizeFirstLetter(string) {
                return string.charAt(0).toUpperCase() + string.slice(1);
            }
            
            // Update Client Dropdown
            function updateClientDropdown(clients) {
                // Clear dropdown
                automationClient.innerHTML = '<option value="">Selecione um cliente</option>';
                
                // Add options
                clients.forEach(client => {
                    automationClient.innerHTML += `<option value="${client.id}">${client.nome}</option>`;
                });
            }
            
            // Setup Pagination
            function setupPagination(container, currentPage, totalPages, callback, param = '') {
                container.innerHTML = '';
                
                if (totalPages <= 1) {
                    return;
                }
                
                // Previous button
                container.innerHTML += `
                    <button class="pagination-item ${currentPage === 1 ? 'disabled' : ''}" 
                            ${currentPage === 1 ? 'disabled' : ''}
                            data-page="${currentPage - 1}" data-param="${param}">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                `;
                
                // Page buttons
                const startPage = Math.max(1, currentPage - 2);
                const endPage = Math.min(totalPages, startPage + 4);
                
                for (let i = startPage; i <= endPage; i++) {
                    container.innerHTML += `
                        <button class="pagination-item ${i === currentPage ? 'active' : ''}" 
                                data-page="${i}" data-param="${param}">
                            ${i}
                        </button>
                `;
                }
                
                // Next button
                container.innerHTML += `
                    <button class="pagination-item ${currentPage === totalPages ? 'disabled' : ''}" 
                            ${currentPage === totalPages ? 'disabled' : ''}
                            data-page="${currentPage + 1}" data-param="${param}">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                `;
                
                // Add event listeners
                container.querySelectorAll('.pagination-item').forEach(item => {
                    if (!item.disabled) {
                        item.addEventListener('click', function() {
                            const page = parseInt(this.dataset.page);
                            const param = this.dataset.param;
                            callback(page, param);
                        });
                    }
                });
            }
            
            // Add Client Action Listeners
            function addClientActionListeners() {
                document.querySelectorAll('.client-action').forEach(button => {
                    button.addEventListener('click', function() {
                        const id = this.dataset.id;
                        
                        if (this.classList.contains('view')) {
                            viewClient(id);
                        } else if (this.classList.contains('edit')) {
                            editClient(id);
                        } else if (this.classList.contains('delete')) {
                            deleteClient(id);
                        }
                    });
                });
            }
            
            // Add Ticket Action Listeners
            function addTicketActionListeners() {
                document.querySelectorAll('.ticket-action').forEach(button => {
                    button.addEventListener('click', function() {
                        const id = this.dataset.id;
                        
                        if (this.classList.contains('view')) {
                            viewTicket(id);
                        } else if (this.classList.contains('edit')) {
                            editTicket(id);
                        }
                    });
                });
            }
            
            // Show Toast Notification
            function showToast(title, message, type = 'success') {
                const toast = document.createElement('div');
                toast.className = 'toast';
                toast.innerHTML = `
                    <div class="toast-icon ${type}">
                        <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : type === 'info' ? 'info-circle' : 'exclamation-triangle'}"></i>
                    </div>
                    <div class="toast-content">
                        <div class="toast-title">${title}</div>
                        <div class="toast-message">${message}</div>
                    </div>
                    <button class="toast-close">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                // Add close button event listener
                toast.querySelector('.toast-close').addEventListener('click', () => {
                    toast.remove();
                });
                
                // Add to container
                document.getElementById('toastContainer').appendChild(toast);
                
                // Auto remove after 5 seconds
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.remove();
                    }
                }, 5000);
            }
            
            // Debounce Function for Search Input
            function debounce(func, wait) {
                let timeout;
                
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }
            
            // Fetch with Authentication
            async function fetchWithAuth(url, options = {}) {
                const token = sessionStorage.getItem('authToken');
                
                // Add authorization header
                const headers = {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${token}`,
                    ...options.headers
                };
                
                try {
                    const response = await fetch(url, {
                        ...options,
                        headers
                    });
                    
                    if (!response.ok) {
                        // Handle unauthorized (token expired)
                        if (response.status === 401) {
                            logout();
                            throw new Error('Sessão expirada. Por favor, faça login novamente.');
                        }
                        
                        throw new Error(`Erro HTTP ${response.status}: ${response.statusText}`);
                    }
                    
                    // Parse JSON response
                    const data = await response.json();
                    return data;
                } catch (error) {
                    console.error('Fetch error:', error);
                    
                    // For demonstration/development only - return mock data
                    // In production, this would be removed and the error would be thrown
                    console.log('Using mock data for development/testing');
                    return getMockData(url);
                }
            }
            
            // =====================
            // Action Functions
            // =====================
            
            // View Client
            function viewClient(id) {
                showToast('Visualizar Cliente', `Visualizando detalhes do cliente #${id}`, 'info');
                // In a real implementation, this would navigate to a client details page or open a modal
            }
            
            // Edit Client
            function editClient(id) {
                showToast('Editar Cliente', `Editando cliente #${id}`, 'info');
                // In a real implementation, this would open a modal with the client's data pre-filled
            }
            
            // Delete Client
            function deleteClient(id) {
                // Show confirmation dialog
                if (confirm('Tem certeza que deseja remover este cliente? Esta ação não pode ser desfeita.')) {
                    // In a real implementation, this would send a DELETE request to the API
                    showToast('Cliente Removido', `Cliente #${id} foi removido com sucesso`, 'success');
                    
                    // Reload clients
                    loadClients();
                }
            }
            
            // View Ticket
            function viewTicket(id) {
                showToast('Visualizar Ticket', `Visualizando detalhes do ticket #${id}`, 'info');
                // In a real implementation, this would navigate to a ticket details page or open a modal
            }
            
            // Edit Ticket
            function editTicket(id) {
                showToast('Editar Ticket', `Editando ticket #${id}`, 'info');
                // In a real implementation, this would open a modal with the ticket's data pre-filled
            }
            
            // Open Client Modal
            function openClientModal() {
                document.getElementById('newClientForm').reset();
                newClientModal.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
            
            // Close Client Modal
            function closeClientModal() {
                newClientModal.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
            
            // Submit Client
            async function submitClient() {
                // Get form values
                const clientName = document.getElementById('clientName').value;
                const contactName = document.getElementById('contactName').value;
                const clientEmail = document.getElementById('clientEmail').value;
                const clientPhone = document.getElementById('clientPhone').value;
                const clientStatus = document.getElementById('clientStatus').value;
                const serviceAssistenteIA = document.getElementById('serviceAssistenteIA').checked;
                const serviceDashboards = document.getElementById('serviceDashboards').checked;
                const serviceWhatsApp = document.getElementById('serviceWhatsApp').checked;
                
                // Validate form
                if (!clientName || !contactName || !clientEmail) {
                    showToast('Campos Obrigatórios', 'Por favor, preencha todos os campos obrigatórios', 'warning');
                    return;
                }
                
                // Show loading state
                submitClientBtn.innerHTML = '<span class="loading-spinner"></span>';
                submitClientBtn.disabled = true;
                
                try {
                    // Prepare services array
                    const services = [];
                    if (serviceAssistenteIA) services.push('ia-sdr');
                    if (serviceDashboards) services.push('dashboards');
                    if (serviceWhatsApp) services.push('whatsapp');
                    
                    // Prepare request body
                    const clientData = {
                        nome: clientName,
                        contato: contactName,
                        email: clientEmail,
                        telefone: clientPhone,
                        status: clientStatus,
                        servicos: services
                    };
                    
                    // In a real implementation, this would send a POST request to the API
                    // For demonstration, we'll simulate success after a delay
                    setTimeout(() => {
                        // Show success message
                        showToast('Cliente Adicionado', 'Cliente adicionado com sucesso', 'success');
                        
                        // Close modal
                        closeClientModal();
                        
                        // Reset button
                        submitClientBtn.innerHTML = '<span class="btn-text">Adicionar Cliente</span>';
                        submitClientBtn.disabled = false;
                        
                        // Reload clients
                        loadClients();
                    }, 1500);
                } catch (error) {
                    console.error('Erro ao adicionar cliente:', error);
                    
                    // Show error message
                    showToast('Erro', 'Não foi possível adicionar o cliente. Tente novamente mais tarde.', 'error');
                    
                    // Reset button
                    submitClientBtn.innerHTML = '<span class="btn-text">Adicionar Cliente</span>';
                    submitClientBtn.disabled = false;
                }
            }
            
            // Open Automation Modal
            function openAutomationModal() {
                // Reset form
                document.getElementById('automationClient').selectedIndex = 0;
                document.getElementById('automationName').value = '';
                document.getElementById('automationDescription').value = '';
                
                // Reset automation type selection
                automationTypeOptions.forEach((option, index) => {
                    option.classList.toggle('active', index === 0);
                });
                
                // Show modal
                newAutomationModal.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
            
            // Close Automation Modal
            function closeAutomationModal() {
                newAutomationModal.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
            
            // Submit Automation
            async function submitAutomation() {
                // Get form values
                const clientId = document.getElementById('automationClient').value;
                const automationName = document.getElementById('automationName').value;
                const automationDescription = document.getElementById('automationDescription').value;
                const automationType = document.querySelector('.automation-type-option.active').dataset.type;
                
                // Validate form
                if (!clientId || !automationName) {
                    showToast('Campos Obrigatórios', 'Por favor, preencha todos os campos obrigatórios', 'warning');
                    return;
                }
                
                // Show loading state
                submitAutomationBtn.innerHTML = '<span class="loading-spinner"></span>';
                submitAutomationBtn.disabled = true;
                
                try {
                    // Prepare request body
                    const automationData = {
                        cliente_id: clientId,
                        nome: automationName,
                        descricao: automationDescription,
                        tipo: automationType
                    };
                    
                    // In a real implementation, this would send a POST request to the API
                    // For demonstration, we'll simulate success after a delay
                    setTimeout(() => {
                        // Show success message
                        showToast('Automação Criada', 'Automação criada com sucesso', 'success');
                        
                        // Close modal
                        closeAutomationModal();
                        
                        // Reset button
                        submitAutomationBtn.innerHTML = '<span class="btn-text">Criar Automação</span>';
                        submitAutomationBtn.disabled = false;
                        
                        // In a real implementation, this might reload some data
                        loadDashboardStats();
                    }, 1500);
                } catch (error) {
                    console.error('Erro ao criar automação:', error);
                    
                    // Show error message
                    showToast('Erro', 'Não foi possível criar a automação. Tente novamente mais tarde.', 'error');
                    
                    // Reset button
                    submitAutomationBtn.innerHTML = '<span class="btn-text">Criar Automação</span>';
                    submitAutomationBtn.disabled = false;
                }
            }
            
            // Open Ticket Modal
            function openTicketModal() {
                showToast('Funcionalidade em Desenvolvimento', 'A criação de tickets será disponibilizada em breve.', 'info');
            }
            
            // View All Clients
            function viewAllClients() {
                showToast('Navegação', 'Redirecionando para a página de clientes...', 'info');
                // In a real implementation, this would navigate to a clients page
            }
            
            // View All Tickets
            function viewAllTickets() {
                showToast('Navegação', 'Redirecionando para a página de tickets...', 'info');
                // In a real implementation, this would navigate to a tickets page
            }
            
            // =====================
            // Mock Data Functions
            // =====================
            
            // Get Mock Data based on URL
            function getMockData(url) {
                // Extract endpoint from URL
                const endpoint = url.split('?')[0].split('/').pop();
                
                // Return appropriate mock data based on endpoint
                switch (endpoint) {
                    case 'estatisticas-gerais':
                        return {
                            clientes_ativos: 48,
                            crescimento_clientes: 12,
                            automacoes_ativas: 156,
                            crescimento_automacoes: 8,
                            tickets_abertos: 23,
                            crescimento_tickets: -5,
                            taxa_conversao: 42,
                            crescimento_conversao: 15
                        };
                    
                    case 'metricas-performance':
                        return {
                            periodo: "semanal",
                            labels: ["Seg", "Ter", "Qua", "Qui", "Sex", "Sáb", "Dom"],
                            datasets: [
                                {
                                    label: "Atendimentos",
                                    data: [153, 182, 176, 234, 248, 180, 145]
                                },
                                {
                                    label: "Leads Gerados",
                                    data: [42, 53, 48, 68, 75, 62, 45]
                                },
                                {
                                    label: "Conversões",
                                    data: [18, 25, 22, 30, 32, 26, 19]
                                }
                            ]
                        };
                    
                    case 'clientes':
                        return {
                            total: 48,
                            clientes: [
                                {
                                    id: "C001",
                                    nome: "Tech Solutions Brasil",
                                    contato: "Marina Silva",
                                    email: "marina@techsolutions.com.br",
                                    telefone: "(11) 98765-4321",
                                    avatar: "",
                                    saude: 92,
                                    vendas: 45800,
                                    status: "ativo"
                                },
                                {
                                    id: "C002",
                                    nome: "Global Connect",
                                    contato: "João Pereira",
                                    email: "joao@globalconnect.com",
                                    telefone: "(21) 97654-3210",
                                    avatar: "",
                                    saude: 78,
                                    vendas: 32500,
                                    status: "ativo"
                                },
                                {
                                    id: "C003",
                                    nome: "Innova Marketing",
                                    contato: "Carolina Lima",
                                    email: "carolina@innovamarketing.com.br",
                                    telefone: "(31) 96543-2109",
                                    avatar: "",
                                    saude: 65,
                                    vendas: 28700,
                                    status: "pendente"
                                },
                                {
                                    id: "C004",
                                    nome: "Smart Retail",
                                    contato: "Rafael Costa",
                                    email: "rafael@smartretail.com.br",
                                    telefone: "(41) 95432-1098",
                                    avatar: "",
                                    saude: 45,
                                    vendas: 15300,
                                    status: "inativo"
                                },
                                {
                                    id: "C005",
                                    nome: "Future Finance",
                                    contato: "Amanda Oliveira",
                                    email: "amanda@futurefinance.com.br",
                                    telefone: "(51) 94321-0987",
                                    avatar: "",
                                    saude: 88,
                                    vendas: 39200,
                                    status: "ativo"
                                }
                            ]
                        };
                    
                    case 'atividades-recentes':
                        return {
                            atividades: [
                                {
                                    id: "AT001",
                                    tipo: "venda",
                                    data: new Date(Date.now() - 30 * 60000).toISOString(),
                                    mensagem: "Smart Retail fechou contrato de Assistente IA SDR no valor de R$ 5.800",
                                    cliente_id: "C004",
                                    cliente_nome: "Smart Retail",
                                    link_detalhes: "#"
                                },
                                {
                                    id: "AT002",
                                    tipo: "mensagem",
                                    data: new Date(Date.now() - 2 * 60 * 60000).toISOString(),
                                    mensagem: "Amanda da Future Finance solicitou reunião para discutir expansão de automações",
                                    cliente_id: "C005",
                                    cliente_nome: "Future Finance",
                                    link_detalhes: "#"
                                },
                                {
                                    id: "AT003",
                                    tipo: "automacao",
                                    data: new Date(Date.now() - 5 * 60 * 60000).toISOString(),
                                    mensagem: "Nova automação de WhatsApp configurada para Tech Solutions Brasil",
                                    cliente_id: "C001",
                                    cliente_nome: "Tech Solutions Brasil",
                                    link_detalhes: "#"
                                },
                                {
                                    id: "AT004",
                                    tipo: "alerta",
                                    data: new Date(Date.now() - 24 * 60 * 60000).toISOString(),
                                    mensagem: "Baixa performance em campanha de email para Innova Marketing. Taxa de abertura abaixo de 15%.",
                                    cliente_id: "C003",
                                    cliente_nome: "Innova Marketing",
                                    link_detalhes: "#"
                                },
                                {
                                    id: "AT005",
                                    tipo: "venda",
                                    data: new Date(Date.now() - 2 * 24 * 60 * 60000).toISOString(),
                                    mensagem: "Global Connect ampliou contrato de Dashboards em R$ 3.200 mensais",
                                    cliente_id: "C002",
                                    cliente_nome: "Global Connect",
                                    link_detalhes: "#"
                                }
                            ]
                        };
                    
                    case 'tickets':
                        return {
                            total: 23,
                            tickets: [
                                {
                                    id: "TK-2025-0001",
                                    assunto: "Integração com CRM Salesforce",
                                    cliente_id: "C001",
                                    cliente_nome: "Tech Solutions Brasil",
                                    cliente_avatar: "",
                                    conteudo: "Precisamos integrar o assistente de IA com nosso CRM Salesforce para sincronizar leads.",
                                    data_criacao: new Date(Date.now() - 2 * 24 * 60 * 60000).toISOString(),
                                    prioridade: "alta",
                                    status: "em_andamento"
                                },
                                {
                                    id: "TK-2025-0002",
                                    assunto: "Erro no dashboard de conversões",
                                    cliente_id: "C002",
                                    cliente_nome: "Global Connect",
                                    cliente_avatar: "",
                                    conteudo: "O dashboard de conversões está mostrando dados inconsistentes desde ontem.",
                                    data_criacao: new Date(Date.now() - 1 * 24 * 60 * 60000).toISOString(),
                                    prioridade: "media",
                                    status: "aberto"
                                },
                                {
                                    id: "TK-2025-0003",
                                    assunto: "Solicitação de nova automação",
                                    cliente_id: "C005",
                                    cliente_nome: "Future Finance",
                                    cliente_avatar: "",
                                    conteudo: "Gostaríamos de implementar uma nova automação para qualificação de leads via LinkedIn.",
                                    data_criacao: new Date(Date.now() - 3 * 24 * 60 * 60000).toISOString(),
                                    prioridade: "baixa",
                                    status: "aberto"
                                },
                                {
                                    id: "TK-2025-0004",
                                    assunto: "Problema com mensagens WhatsApp",
                                    cliente_id: "C003",
                                    cliente_nome: "Innova Marketing",
                                    cliente_avatar: "",
                                    conteudo: "As mensagens automáticas de WhatsApp estão sendo enviadas duplicadas.",
                                    data_criacao: new Date(Date.now() - 5 * 24 * 60 * 60000).toISOString(),
                                    prioridade: "alta",
                                    status: "resolvido"
                                },
                                {
                                    id: "TK-2025-0005",
                                    assunto: "Treinamento para equipe",
                                    cliente_id: "C004",
                                    cliente_nome: "Smart Retail",
                                    cliente_avatar: "",
                                    conteudo: "Solicitação de treinamento adicional para nossa equipe de vendas usar o sistema.",
                                    data_criacao: new Date(Date.now() - 7 * 24 * 60 * 60000).toISOString(),
                                    prioridade: "media",
                                    status: "fechado"
                                }
                            ]
                        };
                    
                    default:
                        console.error(`Endpoint não reconhecido: ${endpoint}`);
                        return null;
                }
            }
            
            // Make functions available globally for event handlers
            window.loadDashboardStats = loadDashboardStats;
            window.loadPerformanceChart = loadPerformanceChart;
            window.loadClients = loadClients;
            window.loadActivities = loadActivities;
            window.loadTickets = loadTickets;
        });
    </script>
</body>
</html>
