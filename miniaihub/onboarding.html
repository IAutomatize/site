<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configure sua conta | MiniIA Hub</title>
    <meta name="description" content="Configure sua conta no MiniIA Hub e conecte-se às ferramentas Google para automatizar seus fluxos de trabalho com Mini-IAs inteligentes.">
    
    <!-- Fontes precarregadas para otimização -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&family=Poppins:wght@600;700&display=swap" rel="stylesheet">
    
    <!-- CSS crítico inline para carregamento mais rápido -->
    <style>
        :root {
            --color-primary: #2D9CDB;
            --color-primary-dark: #2188c2;
            --color-secondary: #27AE60;
            --color-dark: #333333;
            --color-light: #F2F2F2;
            --color-gray: #828282;
            --color-white: #FFFFFF;
            --font-heading: 'Poppins', sans-serif;
            --font-body: 'Inter', sans-serif;
        }
        * {margin: 0; padding: 0; box-sizing: border-box;}
        body {
            font-family: var(--font-body);
            color: var(--color-dark);
            background-color: var(--color-light);
            line-height: 1.6;
        }
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        .navbar {
            padding: 15px 0;
            background-color: var(--color-white);
            border-bottom: 1px solid var(--color-light);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .onboarding-header {
            text-align: center;
            margin: 30px 0;
        }
        .step-content {
            background-color: var(--color-white);
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            padding: 25px;
            max-width: 800px;
            margin: 0 auto 30px;
        }
        /* Loading spinner para indicar carregamento dinâmico */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(45, 156, 219, 0.3);
            border-radius: 50%;
            border-top-color: var(--color-primary);
            animation: spin 1s ease-in-out infinite;
            margin: 0 auto;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .loading-container {
            text-align: center;
            padding: 40px 0;
        }
    </style>
    
    <!-- CSS não crítico carregado de forma assíncrona -->
    <link rel="preload" href="css/onboarding.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="css/onboarding.css"></noscript>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="container navbar-container">
            <a href="/" class="navbar-logo">
                <svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M18 3C9.716 3 3 9.716 3 18C3 26.284 9.716 33 18 33C26.284 33 33 26.284 33 18C33 9.716 26.284 3 18 3Z" fill="#2D9CDB"/>
                    <path d="M24 13L16 21L12 17" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M14 25L10 21L14 17" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M22 9L26 13L22 17" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>MiniIA Hub</span>
            </a>
            
            <button class="theme-toggle" aria-label="Alternar modo escuro">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M12 2V4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M12 20V22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M4.93 4.93L6.34 6.34" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M17.66 17.66L19.07 19.07" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M2 12H4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M20 12H22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M6.34 17.66L4.93 19.07" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M19.07 4.93L17.66 6.34" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
        </div>
    </nav>

    <!-- Onboarding -->
    <section class="onboarding">
        <div class="container">
            <div class="onboarding-header">
                <h1>Bem-vindo ao MiniIA Hub!</h1>
                <p>Vamos configurar sua conta para automatizar seus fluxos de trabalho com as ferramentas do Google.</p>
            </div>
            
            <div class="steps">
                <div class="step-item active" data-step="1">
                    <div class="step-number">1</div>
                    <div class="step-label">Conectar ferramentas</div>
                </div>
                <div class="step-item" data-step="2">
                    <div class="step-number">2</div>
                    <div class="step-label">Instalar Mini-IA</div>
                </div>
                <div class="step-item" data-step="3">
                    <div class="step-number">3</div>
                    <div class="step-label">Confirmar</div>
                </div>
            </div>
            
            <!-- Step 1: Connect Google Services -->
            <div class="step-content" id="step-1">
                <h2 class="step-content-title">Conecte suas ferramentas Google</h2>
                <p class="step-content-description">Escolha quais ferramentas do Google você deseja conectar para automatizar seus fluxos de trabalho.</p>
                
                <div class="search-input">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 21L16.65 16.65M19 11C19 15.4183 15.4183 19 11 19C6.58172 19 3 15.4183 3 11C3 6.58172 6.58172 3 11 3C15.4183 3 19 6.58172 19 11Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <input type="text" placeholder="Buscar ferramentas Google..." id="google-services-search">
                </div>
                
                <!-- Placeholder para carregamento dinâmico das ferramentas Google -->
                <div id="google-services-container" class="connect-options">
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                        <p>Carregando ferramentas do Google...</p>
                    </div>
                </div>
                
                <!-- OAuth Details - visível somente após seleção de serviço -->
                <div id="oauth-details" style="display: none;">
                    <h3 class="step-content-subtitle">Conecte sua conta do <span id="selected-service">Google</span></h3>
                    
                    <p class="step-content-description">Utilizamos OAuth2 para conectar de forma segura com sua conta. Suas credenciais nunca são armazenadas em nosso servidor.</p>
                    
                    <div class="oauth-connector">
                        <button id="oauth-connect-button" class="btn btn-primary btn-lg">
                            <span id="oauth-button-text">Conectar</span>
                            <span id="oauth-loading" style="display: none;">
                                <span class="loading-spinner-inline"></span>
                                Conectando...
                            </span>
                        </button>
                        
                        <div id="oauth-success" class="oauth-status" style="display: none;">
                            <svg class="oauth-icon success" width="24" height="24" viewBox="0 0 24 24">
                                <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM10 17L5 12L6.41 10.59L10 14.17L17.59 6.58L19 8L10 17Z" fill="#27AE60"/>
                            </svg>
                            <span>Conectado com sucesso!</span>
                        </div>
                        
                        <div id="oauth-error" class="oauth-status" style="display: none;">
                            <svg class="oauth-icon error" width="24" height="24" viewBox="0 0 24 24">
                                <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM13 17H11V15H13V17ZM13 13H11V7H13V13Z" fill="#EB5757"/>
                            </svg>
                            <span>Erro na conexão. Tente novamente.</span>
                        </div>
                    </div>
                </div>
                
                <div class="step-navigation">
                    <a href="/" class="btn btn-outline">Cancelar</a>
                    <button id="next-step-1" class="btn btn-primary">Próximo passo</button>
                </div>
            </div>
            
            <!-- Step 2: Install Mini-IAs -->
            <div class="step-content" id="step-2" style="display: none;">
                <h2 class="step-content-title">Escolha suas Mini-IAs</h2>
                <p class="step-content-description">Selecione as Mini-IAs que deseja utilizar com suas ferramentas Google.</p>
                
                <div class="search-input">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 21L16.65 16.65M19 11C19 15.4183 15.4183 19 11 19C6.58172 19 3 15.4183 3 11C3 6.58172 6.58172 3 11 3C15.4183 3 19 6.58172 19 11Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <input type="text" placeholder="Buscar Mini-IAs..." id="miniai-search">
                </div>
                
                <!-- Container para carregamento dinâmico de Mini-IAs -->
                <div id="miniai-container" class="connector-list">
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                        <p>Carregando Mini-IAs disponíveis...</p>
                    </div>
                </div>
                
                <div class="step-navigation">
                    <button id="prev-step-2" class="btn btn-outline">Anterior</button>
                    <button id="next-step-2" class="btn btn-primary">Próximo passo</button>
                </div>
            </div>
            
            <!-- Step 3: Confirmation -->
            <div class="step-content" id="step-3" style="display: none;">
                <h2 class="step-content-title">Tudo pronto!</h2>
                <p class="step-content-description">Suas ferramentas Google foram conectadas e suas Mini-IAs estão prontas para uso.</p>
                
                <div class="success-animation">
                    <svg viewBox="0 0 52 52" xmlns="http://www.w3.org/2000/svg">
                        <circle class="checkmark-circle" cx="26" cy="26" r="25" fill="none"/>
                        <path class="checkmark" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/>
                    </svg>
                </div>
                
                <h3 class="step-content-subtitle">Ferramentas conectadas</h3>
                
                <!-- Container para exibir as ferramentas conectadas -->
                <div id="connected-services-container" class="connected-services">
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                        <p>Carregando informações...</p>
                    </div>
                </div>
                
                <h3 class="step-content-subtitle">Mini-IAs instaladas</h3>
                
                <!-- Container para exibir as Mini-IAs instaladas -->
                <div id="installed-miniais-container" class="installed-miniais">
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                        <p>Carregando informações...</p>
                    </div>
                </div>
                
                <div class="step-navigation">
                    <button id="prev-step-3" class="btn btn-outline">Anterior</button>
                    <button id="go-to-dashboard" class="btn btn-primary btn-lg">Ir para o Dashboard</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Toast Notifications Container -->
    <div class="toast-container">
        <!-- Toast notifications will be dynamically added here -->
    </div>

    <!-- Carregar primeiro recursos críticos -->
    <script src="js/oauth-loader.js"></script>
    
    <!-- Carregar recursos não críticos de forma assíncrona -->
    <script>
        // Função para carregar scripts de forma assíncrona
        function loadScript(src, callback) {
            const script = document.createElement('script');
            script.src = src;
            script.onload = callback;
            document.body.appendChild(script);
        }
        
        // Adicionar classes para mobile-first design
        function addMobileClasses() {
            if (window.innerWidth <= 768) {
                document.body.classList.add('mobile-view');
            } else {
                document.body.classList.remove('mobile-view');
            }
        }
        
        // Carregar CSS completo
        loadScript('js/onboarding.js', () => {
            console.log('Recursos carregados completamente');
        });
        
        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            // Verificar e adicionar classes para mobile
            addMobileClasses();
            window.addEventListener('resize', addMobileClasses);
            
            // Verificar token no localStorage
            if (!localStorage.getItem('miniai_token')) {
                // Se não tiver token, redirecionar para a página de login
                console.warn('Token não encontrado no localStorage. Redirecionando para login...');
                // Comentado para não redirecionar durante o desenvolvimento
                // window.location.href = '/login.html';
            }
            
            // Inicializar carregamento de serviços Google
            loadGoogleServices();
        });
        
        // Carregar serviços Google dinamicamente
        async function loadGoogleServices() {
            try {
                const servicesContainer = document.getElementById('google-services-container');
                
                // Buscar serviços disponíveis
                const services = await oauthLoader.getAvailableGoogleServices();
                
                // Limpar container de loading
                servicesContainer.innerHTML = '';
                
                // Renderizar cada serviço
                services.forEach(service => {
                    const serviceCard = document.createElement('div');
                    serviceCard.className = 'connect-option';
                    serviceCard.setAttribute('data-service-id', service.id);
                    
                    serviceCard.innerHTML = `
                        <div class="connect-option-icon">
                            <img src="${service.icon || '/api/placeholder/60/60'}" alt="${service.name}" />
                        </div>
                        <div class="connect-option-name">${service.name}</div>
                        <div class="connect-option-description">${service.description || 'Serviço Google'}</div>
                    `;
                    
                    // Verificar se já está autenticado
                    if (oauthLoader.isAuthenticated(service.id)) {
                        serviceCard.classList.add('connected');
                    }
                    
                    // Adicionar evento de clique
                    serviceCard.addEventListener('click', () => selectService(service));
                    
                    servicesContainer.appendChild(serviceCard);
                });
                
                if (services.length === 0) {
                    servicesContainer.innerHTML = '<p class="empty-state">Nenhum serviço Google disponível no momento. Tente novamente mais tarde.</p>';
                }
            } catch (error) {
                console.error('Erro ao carregar serviços Google:', error);
                document.getElementById('google-services-container').innerHTML = 
                    '<p class="error-state">Erro ao carregar serviços. <button class="btn-retry">Tentar novamente</button></p>';
                
                // Adicionar evento ao botão de retry
                document.querySelector('.btn-retry')?.addEventListener('click', loadGoogleServices);
            }
        }
        
        // Selecionar um serviço Google
        function selectService(service) {
            // Remover seleção anterior
            document.querySelectorAll('.connect-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // Selecionar o serviço clicado
            document.querySelector(`[data-service-id="${service.id}"]`).classList.add('selected');
            
            // Atualizar detalhes OAuth
            document.getElementById('selected-service').textContent = service.name;
            document.getElementById('oauth-button-text').textContent = `Conectar ${service.name}`;
            document.getElementById('oauth-success').style.display = 'none';
            document.getElementById('oauth-error').style.display = 'none';
            document.getElementById('oauth-connect-button').disabled = false;
            
            // Mostrar detalhes OAuth
            document.getElementById('oauth-details').style.display = 'block';
            
            // Configurar botão de conexão
            document.getElementById('oauth-connect-button').onclick = async () => {
                // Mostrar loading
                document.getElementById('oauth-button-text').style.display = 'none';
                document.getElementById('oauth-loading').style.display = 'inline-block';
                
                try {
                    // Iniciar fluxo OAuth
                    const success = await oauthLoader.startOAuth2Flow(service.id);
                    
                    // Esconder loading
                    document.getElementById('oauth-loading').style.display = 'none';
                    document.getElementById('oauth-button-text').style.display = 'inline-block';
                    
                    if (success) {
                        // Mostrar sucesso
                        document.getElementById('oauth-success').style.display = 'flex';
                        document.getElementById('oauth-error').style.display = 'none';
                        
                        // Adicionar classe connected ao serviço
                        document.querySelector(`[data-service-id="${service.id}"]`).classList.add('connected');
                        
                        // Mostrar toast de sucesso
                        showToast(`${service.name} conectado com sucesso!`, 'success');
                    } else {
                        // Mostrar erro
                        document.getElementById('oauth-error').style.display = 'flex';
                        document.getElementById('oauth-success').style.display = 'none';
                        
                        // Mostrar toast de erro
                        showToast(`Erro ao conectar ${service.name}. Tente novamente.`, 'error');
                    }
                } catch (error) {
                    console.error('Erro ao conectar serviço:', error);
                    
                    // Esconder loading
                    document.getElementById('oauth-loading').style.display = 'none';
                    document.getElementById('oauth-button-text').style.display = 'inline-block';
                    
                    // Mostrar erro
                    document.getElementById('oauth-error').style.display = 'flex';
                    document.getElementById('oauth-success').style.display = 'none';
                    
                    // Mostrar toast de erro
                    showToast(`Erro ao conectar ${service.name}. Tente novamente.`, 'error');
                }
            };
        }
        
        // Toast Notifications System
        function showToast(message, type = 'success', duration = 3000) {
            const toastContainer = document.querySelector('.toast-container');
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            
            let icon = '';
            if (type === 'success') {
                icon = `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M22 11.08V12C21.9988 14.1564 21.3005 16.2547 20.0093 17.9818C18.7182 19.709 16.9033 20.9725 14.8354 21.5839C12.7674 22.1953 10.5573 22.1219 8.53447 21.3746C6.51168 20.6273 4.78465 19.2461 3.61096 17.4371C2.43727 15.628 1.87979 13.4881 2.02168 11.3363C2.16356 9.18457 2.99721 7.13633 4.39828 5.49707C5.79935 3.85782 7.69279 2.71538 9.79619 2.24015C11.8996 1.76491 14.1003 1.98234 16.07 2.86" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M22 4L12 14.01L9 11.01" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>`;
            } else if (type === 'error') {
                icon = `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M15 9L9 15" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M9 9L15 15" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>`;
            } else if (type === 'info') {
                icon = `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M12 16V12" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M12 8H12.01" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>`;
            }
            
            toast.innerHTML = `
                <span class="toast-icon">${icon}</span>
                <span>${message}</span>
                <button class="toast-close">&times;</button>
                <div class="toast-progress"></div>
            `;
            
            toastContainer.appendChild(toast);
            
            // Show toast with animation
            setTimeout(() => {
                toast.classList.add('show');
            }, 10);
            
            // Auto close toast
            const timeout = setTimeout(() => {
                closeToast(toast);
            }, duration);
            
            // Close button
            const closeButton = toast.querySelector('.toast-close');
            closeButton.addEventListener('click', () => {
                clearTimeout(timeout);
                closeToast(toast);
            });
        }

        function closeToast(toast) {
            toast.classList.remove('show');
            setTimeout(() => {
                toast.remove();
            }, 300);
        }
        
        // Navegação entre passos
        document.getElementById('next-step-1').addEventListener('click', function() {
            const connectedServices = document.querySelectorAll('.connect-option.connected');
            
            if (connectedServices.length === 0) {
                showToast('Por favor, conecte pelo menos um serviço Google para continuar.', 'error');
                return;
            }
            
            // Ir para o próximo passo
            goToStep(2);
            
            // Carregar Mini-IAs disponíveis
            loadMiniIAs();
        });
        
        document.getElementById('prev-step-2').addEventListener('click', function() {
            goToStep(1);
        });
        
        document.getElementById('next-step-2').addEventListener('click', function() {
            const selectedMiniIAs = document.querySelectorAll('.connector-card.selected');
            
            if (selectedMiniIAs.length === 0) {
                showToast('Por favor, selecione pelo menos uma Mini-IA para continuar.', 'error');
                return;
            }
            
            // Ir para o próximo passo
            goToStep(3);
            
            // Carregar resumo das conexões
            loadSummary();
        });
        
        document.getElementById('prev-step-3').addEventListener('click', function() {
            goToStep(2);
        });
        
        document.getElementById('go-to-dashboard').addEventListener('click', function() {
            window.location.href = '/dashboard.html';
        });
        
        // Navegar para um passo específico
        function goToStep(step) {
            // Esconder todos os passos
            document.querySelectorAll('.step-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // Mostrar o passo desejado
            document.getElementById(`step-${step}`).style.display = 'block';
            
            // Atualizar indicadores de passo
            document.querySelectorAll('.step-item').forEach(item => {
                const itemStep = parseInt(item.getAttribute('data-step'));
                
                item.classList.remove('active', 'completed');
                
                if (itemStep < step) {
                    item.classList.add('completed');
                } else if (itemStep === step) {
                    item.classList.add('active');
                }
            });
            
            // Rolar para o topo
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }
        
        // Carregar Mini-IAs disponíveis para os serviços conectados
        function loadMiniIAs() {
            const miniaiContainer = document.getElementById('miniai-container');
            
            // Obter serviços conectados
            const connectedServices = Array.from(document.querySelectorAll('.connect-option.connected'))
                .map(service => service.getAttribute('data-service-id'));
            
            if (connectedServices.length === 0) {
                miniaiContainer.innerHTML = '<p class="empty-state">Você precisa conectar pelo menos um serviço Google para ver as Mini-IAs disponíveis.</p>';
                return;
            }
            
            // Lógica para carregar Mini-IAs compatíveis com os serviços conectados
            // Como exemplo, vamos mostrar algumas Mini-IAs fixas para demo
            miniaiContainer.innerHTML = `
                <div class="connector-card" data-miniai-id="sheets-automation">
                    <div class="connector-card-image">
                        <img src="/api/placeholder/400/220" alt="Sheets Automation" />
                    </div>
                    <div class="connector-card-content">
                        <div class="connector-card-tags">
                            <span class="connector-card-tag">Google Sheets</span>
                        </div>
                        <h3 class="connector-card-title">Sheets Automation</h3>
                        <p class="connector-card-description">Automatiza tarefas em planilhas do Google Sheets</p>
                    </div>
                </div>
                
                <div class="connector-card" data-miniai-id="gmail-sorter">
                    <div class="connector-card-image">
                        <img src="/api/placeholder/400/220" alt="Gmail Sorter" />
                    </div>
                    <div class="connector-card-content">
                        <div class="connector-card-tags">
                            <span class="connector-card-tag">Gmail</span>
                        </div>
                        <h3 class="connector-card-title">Gmail Sorter</h3>
                        <p class="connector-card-description">Organiza seus e-mails automaticamente</p>
                    </div>
                </div>
                
                <div class="connector-card" data-miniai-id="docs-assistant">
                    <div class="connector-card-image">
                        <img src="/api/placeholder/400/220" alt="Docs Assistant" />
                    </div>
                    <div class="connector-card-content">
                        <div class="connector-card-tags">
                            <span class="connector-card-tag">Google Docs</span>
                        </div>
                        <h3 class="connector-card-title">Docs Assistant</h3>
                        <p class="connector-card-description">Assistente para criação de documentos</p>
                    </div>
                </div>
                
                <div class="connector-card" data-miniai-id="calendar-organizer">
                    <div class="connector-card-image">
                        <img src="/api/placeholder/400/220" alt="Calendar Organizer" />
                    </div>
                    <div class="connector-card-content">
                        <div class="connector-card-tags">
                            <span class="connector-card-tag">Google Calendar</span>
                        </div>
                        <h3 class="connector-card-title">Calendar Organizer</h3>
                        <p class="connector-card-description">Organiza sua agenda automaticamente</p>
                    </div>
                </div>
            `;
            
            // Adicionar eventos de clique
            document.querySelectorAll('.connector-card').forEach(card => {
                card.addEventListener('click', () => {
                    card.classList.toggle('selected');
                });
            });
            
            // Adicionar funcionalidade de busca
            document.getElementById('miniai-search').addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                
                document.querySelectorAll('.connector-card').forEach(card => {
                    const title = card.querySelector('.connector-card-title').textContent.toLowerCase();
                    const description = card.querySelector('.connector-card-description').textContent.toLowerCase();
                    const tags = Array.from(card.querySelectorAll('.connector-card-tag'))
                        .map(tag => tag.textContent.toLowerCase());
                    
                    const match = title.includes(searchTerm) || 
                                 description.includes(searchTerm) || 
                                 tags.some(tag => tag.includes(searchTerm));
                    
                    card.style.display = match ? 'block' : 'none';
                });
            });
        }
        
        // Carregar resumo das conexões e instalações
        function loadSummary() {
            // Obter serviços conectados
            const connectedServices = Array.from(document.querySelectorAll('.connect-option.connected'))
                .map(service => ({
                    id: service.getAttribute('data-service-id'),
                    name: service.querySelector('.connect-option-name').textContent
                }));
            
            // Obter Mini-IAs selecionadas
            const selectedMiniIAs = Array.from(document.querySelectorAll('.connector-card.selected'))
                .map(miniai => ({
                    id: miniai.getAttribute('data-miniai-id'),
                    name: miniai.querySelector('.connector-card-title').textContent
                }));
            
            // Mostrar serviços conectados
            const connectedServicesContainer = document.getElementById('connected-services-container');
            connectedServicesContainer.innerHTML = '';
            
            if (connectedServices.length > 0) {
                const servicesList = document.createElement('ul');
                servicesList.className = 'connected-list';
                
                connectedServices.forEach(service => {
                    const listItem = document.createElement('li');
                    listItem.className = 'connected-item';
                    listItem.innerHTML = `
                        <svg class="connected-icon" width="20" height="20" viewBox="0 0 24 24">
                            <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z" fill="#27AE60"/>
                        </svg>
                        <span>${service.name}</span>
                    `;
                    servicesList.appendChild(listItem);
                });
                
                connectedServicesContainer.appendChild(servicesList);
            } else {
                connectedServicesContainer.innerHTML = '<p class="empty-state">Nenhum serviço Google conectado.</p>';
            }
            
            // Mostrar Mini-IAs instaladas
            const installedMiniAIsContainer = document.getElementById('installed-miniais-container');
            installedMiniAIsContainer.innerHTML = '';
            
            if (selectedMiniIAs.length > 0) {
                const miniaisList = document.createElement('ul');
                miniaisList.className = 'connected-list';
                
                selectedMiniIAs.forEach(miniai => {
                    const listItem = document.createElement('li');
                    listItem.className = 'connected-item';
                    listItem.innerHTML = `
                        <svg class="connected-icon" width="20" height="20" viewBox="0 0 24 24">
                            <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z" fill="#27AE60"/>
                        </svg>
                        <span>${miniai.name}</span>
                    `;
                    miniaisList.appendChild(listItem);
                });
                
                installedMiniAIsContainer.appendChild(miniaisList);
            } else {
                installedMiniAIsContainer.innerHTML = '<p class="empty-state">Nenhuma Mini-IA selecionada.</p>';
            }
            
            // Salvar no localStorage para uso futuro
            try {
                localStorage.setItem('miniai_connected_services', JSON.stringify(connectedServices));
                localStorage.setItem('miniai_installed_miniais', JSON.stringify(selectedMiniIAs));
            } catch (error) {
                console.error('Erro ao salvar dados no localStorage:', error);
            }
        }
    </script>
</body>
</html>
